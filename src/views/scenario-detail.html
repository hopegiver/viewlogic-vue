<div class="scenario-detail-page">
    <!-- ì‹œë‚˜ë¦¬ì˜¤ í—¤ë” -->
    <div class="scenario-hero">
        <div class="hero-background">
            <img :src="scenario.coverImage" :alt="scenario.title" class="hero-bg-image" />
            <div class="hero-overlay"></div>
        </div>
        
        <div class="hero-content">
            <div class="hero-info">
                <!-- ë’¤ë¡œê°€ê¸° ë²„íŠ¼ -->
                <button @click="goBack" class="back-button">
                    â† ì‹œë‚˜ë²„ìŠ¤ë¡œ ëŒì•„ê°€ê¸°
                </button>
                
                <!-- ì‹œë‚˜ë¦¬ì˜¤ ê¸°ë³¸ ì •ë³´ -->
                <div class="scenario-header">
                    <div class="scenario-cover">
                        <img :src="scenario.coverImage" :alt="scenario.title" />
                        <div class="cover-badges">
                            <span v-if="scenario.isNew" class="badge new">NEW</span>
                            <span v-if="scenario.isHot" class="badge hot">HOT</span>
                            <span v-if="scenario.isCompleted" class="badge completed">ì™„ê²°</span>
                        </div>
                    </div>
                    
                    <div class="scenario-info">
                        <h1 class="scenario-title">{{ scenario.title }}</h1>
                        <p class="scenario-author">ì‘ê°€: {{ scenario.author }}</p>
                        <p class="scenario-genre">ì¥ë¥´: {{ scenario.genre }}</p>
                        
                        <div class="scenario-stats">
                            <div class="stat-item">
                                <span class="stat-icon">â­</span>
                                <span class="stat-value">{{ scenario.rating }}</span>
                                <span class="stat-label">({{ formatNumber(scenario.reviewCount) }})</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-icon">ğŸ‘¥</span>
                                <span class="stat-value">{{ formatNumber(scenario.subscribers) }}</span>
                                <span class="stat-label">êµ¬ë…ì</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-icon">ğŸ“š</span>
                                <span class="stat-value">{{ scenario.episodeCount }}</span>
                                <span class="stat-label">í™”</span>
                            </div>
                        </div>
                        
                        <div class="scenario-tags">
                            <span 
                                v-for="tag in scenario.tags" 
                                :key="tag"
                                class="tag"
                            >#{{ tag }}</span>
                        </div>
                        
                        <!-- ê°€ê²© ì •ë³´ -->
                        <div class="scenario-pricing">
                            <div class="pricing-options">
                                <div class="pricing-option main" v-if="!scenario.isPurchased">
                                    <div class="price-info">
                                        <span class="price-label">ì „ì²´ êµ¬ë§¤</span>
                                        <div class="price-display">
                                            <span class="original-price">{{ formatPrice(scenario.originalPrice) }}</span>
                                            <span class="sale-price">{{ formatPrice(scenario.salePrice) }}</span>
                                            <span class="discount-badge">{{ scenario.discount }}% í• ì¸</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="pricing-option monthly" v-if="!scenario.isPurchased">
                                    <div class="price-info">
                                        <span class="price-label">ì›”ê°„ ì´ìš©ê¶Œ</span>
                                        <div class="price-display">
                                            <span class="monthly-price">{{ formatPrice(scenario.monthlyPrice) }}/ì›”</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="pricing-option purchased" v-if="scenario.isPurchased">
                                    <div class="price-info">
                                        <span class="price-label">êµ¬ë§¤ ì™„ë£Œ</span>
                                        <div class="price-display">
                                            <span class="purchased-text">âœ“ ë¬´ì œí•œ ì´ìš© ê°€ëŠ¥</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ì•¡ì…˜ ë²„íŠ¼ë“¤ -->
                        <div class="action-buttons">
                            <button 
                                v-if="!scenario.isPurchased"
                                @click="purchaseOption('full')"
                                class="purchase-btn"
                            >
                                <span class="btn-icon">ğŸ’</span>
                                ì „ì²´ êµ¬ë§¤
                            </button>
                            
                            <button 
                                v-if="!scenario.isPurchased"
                                @click="purchaseOption('monthly')"
                                class="monthly-btn"
                            >
                                <span class="btn-icon">ğŸ“…</span>
                                ì›”ê°„ ì´ìš©ê¶Œ
                            </button>
                            
                            <button 
                                @click="toggleSubscription"
                                class="subscribe-btn"
                                :class="{ subscribed: scenario.isSubscribed }"
                            >
                                <span class="btn-icon">{{ scenario.isSubscribed ? 'ğŸ’–' : 'ğŸ¤' }}</span>
                                {{ scenario.isSubscribed ? 'êµ¬ë…ì¤‘' : 'êµ¬ë…í•˜ê¸°' }}
                            </button>
                            
                            <button @click="shareScenario" class="share-btn">
                                <span class="btn-icon">ğŸ“¤</span>
                                ê³µìœ í•˜ê¸°
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ì‹œë‚˜ë¦¬ì˜¤ ì„¤ëª… -->
    <div class="scenario-description-section">
        <div class="container">
            <h2 class="section-title">ğŸ“– ì‘í’ˆ ì†Œê°œ</h2>
            <div class="description-content">
                <p class="scenario-description">{{ scenario.description }}</p>
                <div class="description-meta">
                    <span class="update-info">ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: {{ formatDate(scenario.lastUpdate) }}</span>
                    <span class="status-info" :class="scenario.status">{{ getStatusText(scenario.status) }}</span>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ì—í”¼ì†Œë“œ ëª©ë¡ -->
    <div class="episodes-section">
        <div class="container">
            <div class="episodes-header">
                <h2 class="section-title">ğŸ“š ì—í”¼ì†Œë“œ ëª©ë¡</h2>
                <div class="episodes-info">
                    <span class="free-info">ğŸ {{ freeEpisodeCount }}í™”ê¹Œì§€ ë¬´ë£Œ</span>
                    <span class="total-info">ì „ì²´ {{ scenario.episodeCount }}í™”</span>
                </div>
            </div>
            
            <!-- ì—í”¼ì†Œë“œ ë¦¬ìŠ¤íŠ¸ -->
            <div class="episodes-list">
                <div 
                    v-for="(episode, index) in episodes" 
                    :key="episode.id"
                    class="episode-item"
                    :class="{
                        'free': episode.isFree,
                        'premium': !episode.isFree,
                        'locked': !episode.isFree && !scenario.isPurchased,
                        'current': currentEpisode === episode.id
                    }"
                    @click="selectEpisode(episode, index)"
                >
                    <div class="episode-number">{{ episode.number }}í™”</div>
                    <div class="episode-info">
                        <h3 class="episode-title">{{ episode.title }}</h3>
                        <p class="episode-preview">{{ episode.preview }}</p>
                        <div class="episode-meta">
                            <span class="episode-date">{{ formatDate(episode.publishDate) }}</span>
                            <span class="episode-length">{{ episode.readTime }}ë¶„</span>
                            <span v-if="episode.isNew" class="episode-badge new">NEW</span>
                        </div>
                    </div>
                    <div class="episode-status">
                        <span v-if="episode.isFree" class="status-badge free">ë¬´ë£Œ</span>
                        <span v-else-if="scenario.isPurchased" class="status-badge purchased">êµ¬ë§¤ì™„ë£Œ</span>
                        <span v-else class="status-badge premium">
                            <span class="premium-icon">ğŸ’</span>
                            {{ formatPrice(episode.price) }}
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ì—í”¼ì†Œë“œ ë·°ì–´ -->
    <div v-if="selectedEpisode" class="episode-viewer">
        <div class="viewer-header">
            <h2>{{ selectedEpisode.number }}í™”: {{ selectedEpisode.title }}</h2>
            <button @click="closeViewer" class="close-viewer">âœ•</button>
        </div>
        
        <div class="viewer-content">
            <!-- ë¬´ë£Œ ë¯¸ë¦¬ë³´ê¸° ì½˜í…ì¸  -->
            <div v-if="selectedEpisode.isFree || scenario.isPurchased" class="episode-content">
                <div v-html="selectedEpisode.content" class="content-text"></div>
            </div>
            
            <!-- ìœ ë£Œ ì½˜í…ì¸  ì ê¸ˆ í™”ë©´ -->
            <div v-else class="premium-lock">
                <!-- ë¬´ë£Œ ë¯¸ë¦¬ë³´ê¸° (10%) -->
                <div class="preview-content">
                    <div class="preview-header">
                        <h3>ğŸ ë¬´ë£Œ ë¯¸ë¦¬ë³´ê¸°</h3>
                        <p>ì´ ì—í”¼ì†Œë“œì˜ {{ previewPercentage }}%ë¥¼ ë¬´ë£Œë¡œ ì œê³µí•©ë‹ˆë‹¤.</p>
                    </div>
                    <div v-html="selectedEpisode.previewContent" class="content-text preview"></div>
                </div>
                
                <!-- ê²°ì œ ìœ ë„ ì„¹ì…˜ -->
                <div class="payment-prompt">
                    <div class="lock-overlay">
                        <div class="lock-icon">ğŸ”’</div>
                        <h3>í”„ë¦¬ë¯¸ì—„ ì½˜í…ì¸ </h3>
                        <p>ì´ ì—í”¼ì†Œë“œì˜ ì „ì²´ ë‚´ìš©ì„ ë³´ë ¤ë©´ êµ¬ë§¤ê°€ í•„ìš”í•©ë‹ˆë‹¤.</p>
                        
                        <div class="payment-options">
                            <button @click="purchaseEpisode(selectedEpisode)" class="purchase-episode-btn">
                                <span class="btn-icon">ğŸ’</span>
                                ì´ ì—í”¼ì†Œë“œë§Œ êµ¬ë§¤ ({{ formatPrice(selectedEpisode.price) }})
                            </button>
                            
                            <button @click="purchaseOption('full')" class="purchase-full-btn">
                                <span class="btn-icon">ğŸ¯</span>
                                ì „ì²´ êµ¬ë§¤í•˜ê³  {{ scenario.discount }}% í• ì¸ë°›ê¸°
                            </button>
                        </div>
                        
                        <div class="payment-benefits">
                            <h4>êµ¬ë§¤ í˜œíƒ</h4>
                            <ul>
                                <li>âœ“ í‰ìƒ ë¬´ì œí•œ ì´ìš©</li>
                                <li>âœ“ ì˜¤í”„ë¼ì¸ ë‹¤ìš´ë¡œë“œ</li>
                                <li>âœ“ ê´‘ê³  ì—†ëŠ” ê¹”ë”í•œ ì½ê¸°</li>
                                <li>âœ“ ìƒˆ ì—í”¼ì†Œë“œ ìš°ì„  ì•Œë¦¼</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ë·°ì–´ ë„¤ë¹„ê²Œì´ì…˜ -->
        <div class="viewer-navigation">
            <button 
                @click="navigateEpisode('prev')" 
                :disabled="selectedEpisodeIndex === 0"
                class="nav-btn prev-btn"
            >
                â† ì´ì „ í™”
            </button>
            
            <div class="episode-progress">
                <span>{{ selectedEpisodeIndex + 1 }} / {{ episodes.length }}</span>
                <div class="progress-bar">
                    <div 
                        class="progress-fill" 
                        :style="{ width: ((selectedEpisodeIndex + 1) / episodes.length * 100) + '%' }"
                    ></div>
                </div>
            </div>
            
            <button 
                @click="navigateEpisode('next')" 
                :disabled="selectedEpisodeIndex === episodes.length - 1"
                class="nav-btn next-btn"
            >
                ë‹¤ìŒ í™” â†’
            </button>
        </div>
    </div>
    
    <!-- ë¦¬ë·° ì„¹ì…˜ -->
    <div class="reviews-section">
        <div class="container">
            <h2 class="section-title">â­ ë…ì ë¦¬ë·°</h2>
            
            <!-- ë¦¬ë·° ì‘ì„± -->
            <div class="review-form">
                <h3>ë¦¬ë·° ì‘ì„±í•˜ê¸°</h3>
                <div class="rating-input">
                    <span>í‰ì :</span>
                    <div class="stars-input">
                        <span 
                            v-for="star in 5" 
                            :key="star"
                            class="star"
                            :class="{ active: star <= newReview.rating }"
                            @click="newReview.rating = star"
                        >â˜…</span>
                    </div>
                </div>
                <textarea 
                    v-model="newReview.content"
                    class="review-textarea"
                    placeholder="ì´ ì‹œë‚˜ë¦¬ì˜¤ì— ëŒ€í•œ ì†”ì§í•œ í›„ê¸°ë¥¼ ë‚¨ê²¨ì£¼ì„¸ìš”..."
                ></textarea>
                <button @click="submitReview" class="submit-review-btn" :disabled="!newReview.content.trim()">
                    ë¦¬ë·° ë“±ë¡
                </button>
            </div>
            
            <!-- ë¦¬ë·° ëª©ë¡ -->
            <div class="reviews-list">
                <div 
                    v-for="review in reviews" 
                    :key="review.id"
                    class="review-item"
                >
                    <div class="review-header">
                        <div class="reviewer-info">
                            <span class="reviewer-name">{{ review.username }}</span>
                            <div class="review-rating">
                                <span v-for="star in 5" :key="star" class="star" :class="{ filled: star <= review.rating }">â˜…</span>
                            </div>
                        </div>
                        <span class="review-date">{{ formatDate(review.date) }}</span>
                    </div>
                    <p class="review-content">{{ review.content }}</p>
                    <div class="review-actions">
                        <button class="review-like" :class="{ liked: review.isLiked }" @click="toggleReviewLike(review)">
                            ğŸ‘ {{ review.likes }}
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>