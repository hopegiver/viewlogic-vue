<div class="video-detail-page">
    <div class="video-detail-container">
        <!-- ë©”ì¸ ì½˜í…ì¸  ì˜ì—­ -->
        <div class="video-main-content">
            <!-- ë¹„ë””ì˜¤ í”Œë ˆì´ì–´ -->
            <div class="video-player-wrapper">
                <div class="video-player" id="videoPlayer">
                    <video :src="currentVideo.videoUrl" controls autoplay>
                        <source :src="currentVideo.videoUrl" type="video/mp4">
                        ë¸Œë¼ìš°ì €ê°€ ë¹„ë””ì˜¤ íƒœê·¸ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
                    </video>
                </div>
            </div>

            <!-- ë¹„ë””ì˜¤ ì •ë³´ -->
            <div class="video-info-section">
                <h1 class="video-title">{{ currentVideo.title }}</h1>
                <div class="video-stats">
                    <div class="stats-left">
                        <span class="view-count">ì¡°íšŒìˆ˜ {{ formatViews(currentVideo.views) }}íšŒ</span>
                        <span class="dot">â€¢</span>
                        <span class="upload-date">{{ currentVideo.uploadedAt }}</span>
                    </div>
                    <div class="stats-right">
                        <button @click="likeVideo" class="action-btn" :class="{ active: isLiked }">
                            <span class="icon">ğŸ‘</span>
                            <span>{{ formatNumber(currentVideo.likes) }}</span>
                        </button>
                        <button @click="dislikeVideo" class="action-btn" :class="{ active: isDisliked }">
                            <span class="icon">ğŸ‘</span>
                        </button>
                        <button @click="shareVideo" class="action-btn">
                            <span class="icon">ğŸ”—</span>
                            <span>ê³µìœ </span>
                        </button>
                        <button @click="saveVideo" class="action-btn" :class="{ active: isSaved }">
                            <span class="icon">ğŸ“Œ</span>
                            <span>ì €ì¥</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- ì±„ë„ ì •ë³´ -->
            <div class="channel-info-section">
                <div class="channel-header">
                    <div class="channel-avatar">
                        <img :src="currentVideo.channelAvatar" :alt="currentVideo.channel">
                    </div>
                    <div class="channel-details">
                        <h3 class="channel-name">{{ currentVideo.channel }}</h3>
                        <p class="subscriber-count">êµ¬ë…ì {{ formatNumber(currentVideo.subscribers) }}ëª…</p>
                    </div>
                    <button @click="toggleSubscribe" class="subscribe-btn" :class="{ subscribed: isSubscribed }">
                        {{ isSubscribed ? 'êµ¬ë…ì¤‘' : 'êµ¬ë…' }}
                    </button>
                </div>
                <div class="video-description">
                    <p v-if="!showFullDescription">
                        {{ truncatedDescription }}
                    </p>
                    <p v-html="currentVideo.description" v-else></p>
                    <button @click="toggleDescription" class="show-more-btn" v-if="currentVideo.description && currentVideo.description.length > 200">
                        {{ showFullDescription ? 'ê°„ëµíˆ' : 'ë”ë³´ê¸°' }}
                    </button>
                </div>
            </div>

            <!-- ëŒ“ê¸€ ì„¹ì…˜ -->
            <div class="comments-section">
                <div class="comments-header">
                    <h3>ëŒ“ê¸€ {{ formatNumber(currentVideo.commentCount) }}ê°œ</h3>
                    <div class="comment-sort">
                        <select v-model="commentSort" @change="sortComments">
                            <option value="top">ì¸ê¸° ëŒ“ê¸€ìˆœ</option>
                            <option value="newest">ìµœì‹ ìˆœ</option>
                        </select>
                    </div>
                </div>

                <!-- ëŒ“ê¸€ ì‘ì„± -->
                <div class="comment-form" v-if="isLoggedIn">
                    <div class="user-avatar">
                        <img :src="currentUser.avatar" :alt="currentUser.name">
                    </div>
                    <div class="comment-input-wrapper">
                        <textarea 
                            v-model="newComment" 
                            @focus="showCommentButtons = true"
                            placeholder="ëŒ“ê¸€ ì¶”ê°€..."
                            rows="1">
                        </textarea>
                        <div class="comment-actions" v-if="showCommentButtons">
                            <button @click="cancelComment" class="cancel-btn">ì·¨ì†Œ</button>
                            <button @click="submitComment" class="submit-btn" :disabled="!newComment.trim()">ëŒ“ê¸€</button>
                        </div>
                    </div>
                </div>

                <!-- ëŒ“ê¸€ ëª©ë¡ -->
                <div class="comments-list">
                    <div v-for="comment in comments" :key="comment.id" class="comment-item">
                        <div class="comment-avatar">
                            <img :src="comment.userAvatar" :alt="comment.userName">
                        </div>
                        <div class="comment-content">
                            <div class="comment-header">
                                <span class="comment-author">{{ comment.userName }}</span>
                                <span class="comment-date">{{ comment.createdAt }}</span>
                            </div>
                            <p class="comment-text">{{ comment.text }}</p>
                            <div class="comment-actions">
                                <button @click="likeComment(comment.id)" class="like-btn" :class="{ liked: comment.isLiked }">
                                    <span class="icon">ğŸ‘</span>
                                    <span v-if="comment.likes > 0">{{ comment.likes }}</span>
                                </button>
                                <button @click="dislikeComment(comment.id)" class="dislike-btn">
                                    <span class="icon">ğŸ‘</span>
                                </button>
                                <button @click="replyToComment(comment.id)" class="reply-btn">ë‹µê¸€</button>
                            </div>

                            <!-- ë‹µê¸€ -->
                            <div v-if="comment.replies && comment.replies.length > 0" class="replies">
                                <button @click="toggleReplies(comment.id)" class="show-replies-btn">
                                    {{ comment.showReplies ? 'ë‹µê¸€ ìˆ¨ê¸°ê¸°' : `ë‹µê¸€ ${comment.replies.length}ê°œ ë³´ê¸°` }}
                                </button>
                                <div v-if="comment.showReplies" class="replies-list">
                                    <div v-for="reply in comment.replies" :key="reply.id" class="reply-item">
                                        <div class="comment-avatar">
                                            <img :src="reply.userAvatar" :alt="reply.userName">
                                        </div>
                                        <div class="comment-content">
                                            <div class="comment-header">
                                                <span class="comment-author">{{ reply.userName }}</span>
                                                <span class="comment-date">{{ reply.createdAt }}</span>
                                            </div>
                                            <p class="comment-text">{{ reply.text }}</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ë”ë³´ê¸° ë²„íŠ¼ -->
                <button v-if="hasMoreComments" @click="loadMoreComments" class="load-more-comments">
                    ëŒ“ê¸€ ë”ë³´ê¸°
                </button>
            </div>
        </div>

        <!-- ì‚¬ì´ë“œë°” - ê´€ë ¨ ë™ì˜ìƒ -->
        <aside class="video-sidebar">
            <div class="sidebar-header">
                <h3>ê´€ë ¨ ë™ì˜ìƒ</h3>
            </div>
            <div class="related-videos">
                <div v-for="video in relatedVideos" :key="video.id" class="related-video-item" @click="playVideo(video.id)">
                    <div class="related-thumbnail">
                        <img :src="video.thumbnail" :alt="video.title">
                        <span class="duration">{{ video.duration }}</span>
                    </div>
                    <div class="related-info">
                        <h4 class="related-title">{{ video.title }}</h4>
                        <p class="related-channel">{{ video.channel }}</p>
                        <div class="related-meta">
                            <span>ì¡°íšŒìˆ˜ {{ formatViews(video.views) }}íšŒ</span>
                            <span class="dot">â€¢</span>
                            <span>{{ video.uploadedAt }}</span>
                        </div>
                    </div>
                </div>
            </div>
        </aside>
    </div>
</div>